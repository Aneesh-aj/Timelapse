<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
    <link rel="stylesheet" href="/style.css" class="style">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <title>Product-adding</title>
</head>   
<body>
      <%- include('navbar2.ejs') %>
   <content class="nav-height">
       <div class="container-fluid   " id="body-color">
           <div class=" d-flex h-auto  profile-main">
               <div class="profile-div ">
                   <div class="profile-photo d-flex align-items-center ">
                       <div class=" hii d-flex justify-content-center align-items-center">
                            <div class="profile-picture " style="background-image: url(https://cdn-icons-png.flaticon.com/128/3001/3001764.png); background-repeat: no-repeat; background-size: cover;"></div>
                       </div>
                       <div class=" hello d-flex align-items-center">
                        <span><a href="/admin" style="text-decoration: none; outline: none; color: black;"  >Admin</a></span>
                       </div>
                   </div>
                   <div class="profile-selection">
                    <div class="selector  d-flex align-items-center">
                       <div class=" hii d-flex align-items-center justify-content-center">
                              <div class="selector-image" style="background-image: url(https://cdn-icons-png.flaticon.com/128/8089/8089114.png); "></div>
                      </div>
                       <div class="hello d-flex align-items-center">
                               <span>order details</span>
                        </div>
                    </div>
                    <div class="line"></div>
                    <div class="selector  d-flex align-items-center">
                     <div class=" hii  d-flex align-items-center justify-content-center">
                            <div class="selector-image" style="background-image: url(https://cdn-icons-png.flaticon.com/128/4379/4379608.png); "></div>
                    </div>
                     <div class=" hello d-flex align-items-center">
                              <span>product</span>
                      </div>
                    </div>
                    <div class="line"></div>
                    <div class="selector  d-flex align-items-center align-items-center">
                        <div class="hii d-flex justify-content-center align-items-center">
                            <div class="selector-image bg-light" style="background-image: url(https://cdn-icons-png.flaticon.com/128/2435/2435281.png); "></div>
                        </div>
                     <div class="hello d-flex align-items-center">
                               <span>user</span>
                        </div>
                     </div>
                    <div class="line"></div>
                    <div class="selector  d-flex align-items-center align-items-center">
                     <div class="hii d-flex justify-content-center align-items-center">
                         <div class="selector-image bg-light" style="background-image: url(https://cdn-icons-png.flaticon.com/128/2435/2435281.png); "></div>
                     </div>
                    <div class="hello d-flex align-items-center">
                            <span>Coupen</span>
                     </div>
                   </div>
                    <div class="line"></div>
                 </div>
               </div>
               <!-- admin/product-managment/adding -->
               <div class="profile-div2  " style="height: auto; margin-bottom: 15px;">             
                    <form method="post" action="/admin/product-managment/adding" enctype="multipart/form-data" onsubmit=" return validateForm()">
                        <div class="w-100 h-100 ">
                            <div class="w-100 d-flex ">
                             <div class="product-img mt-5">
                                 <div class=" " style="width: 60%; height: 2.5rem; margin-left: 5rem;">
                                      <h5>product-image:</h5>
                                 </div>
                                 <div class=" " style="width: 60%; height: 5rem; margin-left: 5rem; background-color: rgb(163, 163, 163); border: black solid 1px;">
                                    <input class="w-100 h-100 ps-3" id="image" type="file" accept=".jpg, .jpeg, .png , .webp" onchange="checkImageCount()" name="filename" multiple>
                                    <span class="error-message" id="image_error"></span>

                                </div>
                                
                                 
                             </div>
                             <div class="product-img-side mt-5">
                                 <div class=" d-flex " style="width: 60%; height: 2.5rem; ">
                                     <h5>product-name:</h5>
                                 </div>
                                 <div class=" " style="width: 60%; height: 2.5rem;  ">
                                      <input class="w-100 h-100 ps-3"for="proudct_name" name="product_name" id="product_name"  style="border-radius: 3px; border: 0.4px rgb(190, 189, 189) solid; box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.2);" >

                                      <span class="error-message" id="product_name_error"></span>

                                 </div>
                                  
                                 <div class=" " style="width: 60%; height: 2.5rem;margin-top: 20px;">
                                     <h5>product price:</h5>
                                 </div>
                                 <div class=" " style="width: 60%; height: 2.5rem; ">
                                      <input onchange="amountcheking()" id="price" class="w-100 h-100 ps-3"for="price" name="price"  style="border-radius: 3px; border: 0.4px rgb(190, 189, 189) solid; box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.2);" >
                                      <span class="error-message" id="price_error"></span>

                                 </div>
                                 <div class=" " style="width: 60%; height: 2.5rem;margin-top: 20px;">
                                     <h5>Category:</h5>
                                 </div>
                                 <div class=" " style="width: 60%; height: 2.5rem; ">
                                      <!-- <input class="w-100 h-100 " style="border-radius: 3px; background-color: rgb(237, 237, 237);"> -->
                                      <select class="form-select w-100 h-100" name="watch_type" id="watch_type" style="border-radius: 3px; border: 0.4px rgb(190, 189, 189) solid; box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.2);" aria-label="Default select example">
                                        <% for (let i = 0; i < watchtype.length; i++) { %>
                                          <option value="<%= watchtype[i]._id %>"<%= product.watch_type && product.watch_type._id.toString() === watchtype[i]._id.toString() ? ' selected' : '' %>><%= watchtype[i].watch_type %></option>
                                        <% } %>
                                      </select>
                                      <span class="error-message" id="watch_type_error"></span>

                                 </div>
                                 <div class=" " style="width: 60%; height: 2.5rem;margin-top: 20px;">
                                     <h5>Brand</h5>
                                 </div>
                                 <div class=" " style="width: 60%; height: 2.5rem; ">
                                    <select class="form-select w-100 h-100" id="brand" name="brand" style="border-radius: 3px; border: 0.4px rgb(190, 189, 189) solid; box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.2);" aria-label="Default select example">
                                        

                                        <% for (let i = 0; i < brands.length; i++) { %>
                                          <option value="<%= brands[i]._id %>"<%= product.brand && product.brand._id.toString() === brands[i]._id.toString() ? ' selected' : '' %>><%= brands[i].brand_category %></option>
                                        <% } %>
                                      </select>
                                      <span class="error-message" id="brand_error"></span>

                                      
                                 </div>
         
                             </div>  
                          </div> 
                          <div class="w-100 " style="padding-left: 5rem;">
                               <div class=" " style="width: 60%; height: 2.5rem;  ">
                                  <h5>product Discription</h5>
                               </div>
                               <div class="" style="width: 60%;    ">
                                  <input type="text" class="w-100" id="discription"  name="discription" style="border-radius: 3px; border: 0.4px rgb(190, 189, 189) solid; box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.2); height: 7rem;" >
                                  <span class="error-message" id="discription_error"></span>

                             </div>
                         
                              <div class="product-img2">
                                <div class="mt-3 d-flex" style="height: 3rem;">
                                    <h5 class="d-flex align-items-center text-details product-img-side2">Display type:</h5>
                                      <div class="w-100">
                                        <input class="w-100 h-75 ps-3" for="display_type" placeholder="display type" style="border-radius: 3px; border: 0.4px rgb(190, 189, 189) solid; box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.2);" name="display_type">
                                        <span class="error-message " id="display_type_error"></span>
                                      </div>
                                </div>
                            
                                <!-- Strap Color -->
                                <div class="mt-3 d-flex" style="height: 3rem;">
                                    <h5 class="d-flex align-items-center text-details product-img-side2">Strap color:</h5>
                                 <div class="w-100">
                                    <input class="w-100 h-75 ps-3" for="strap_color" placeholder="strap color" style="border-radius: 3px; border: 0.4px rgb(190, 189, 189) solid; box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.2);" name="strap_color">
                                    <span class="error-message" id="strap_color_error"></span>
                                 </div>
                                </div>
                            
                                <!-- Dial Color -->
                                <div class="mt-3 d-flex" style="height: 3rem;">
                                    <h5 class="d-flex align-items-center text-details product-img-side2">Dial color:</h5>
                                    <div class="w-100">
                                        <input class="w-100 h-75 ps-3" for="dial_color" placeholder="dial color" style="border-radius: 3px; border: 0.4px rgb(190, 189, 189) solid; box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.2);" name="dial_color">
                                        <span class="error-message" id="dial_color_error"></span>
                                    </div>
                                </div>
                            
                                <!-- Gender -->
                                <div class="mt-3 d-flex" style="height: 3rem;">
                                    <h5 class="d-flex align-items-center text-details product-img-side2">Gender:</h5>
                                  
                                      <div class="w-100">
                                        <input class="w-100 h-75 ps-3" for="gender" placeholder="gender" style="border-radius: 3px; border: 0.4px rgb(190, 189, 189) solid; box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.2)" name="gender">
                                        <span class="error-message" id="gender_error"></span>
                                      </div>
                                     
                                </div>
                            
                                <!-- Shape -->
                                <div class="mt-3 d-flex" style="height:3rem;">
                                    <h5 class="d-flex align-items-center text-details product-img-side2">Shape:</h5>
                                     <div class="w-100">
                                        <input class="w-100 h-75 ps-3" for="shape" placeholder="shape" style="border-radius: 3px; border: 0.4px rgb(190, 189, 189) solid; box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.2);" name="shape">
                                        <span class="error-message" id="shape_error"></span>
                                     </div>
                                </div>
                            
                                <!-- Case Material -->
                                <div class="mt-3 d-flex" style="height: 3rem;">
                                    <h5 class="d-flex align-items-center text-details product-img-side2">Case Material:</h5>
                                     <div class="w-100">
                                        <input class="w-100 h-75 ps-3" for="watch_case" placeholder="case material" style="border-radius: 3px; border: 0.4px rgb(190, 189, 189) solid; box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.2);" name="watch_case">
                                        <span class="error-message" id="watch_case_error"></span>
                                     </div>
                                </div>
                            
                                <div class="mt-3 d-flex" style="height: 3rem;">
                                    <h5 class="d-flex align-items-center text-details product-img-side2">Offer:</h5>
                                     <div class="w-100">
                                              
                                        <input class="w-100 h-75 ps-3" onchange="amountcheking()" for="offer" id="offer" placeholder="flat offer" style="border-radius: 3px; border: 0.4px rgb(190, 189, 189) solid; box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.2);" name="offer">
                                        <span class="error-message" id="offer_error"></span>
                                     </div>
                                  
                                </div>
                                <!-- Stock -->
                                <div class="mt-3 d-flex" style="height: 3rem;">
                                    <h5 class="d-flex align-items-center text-details product-img-side2">Stock:</h5>
                                     <div class="w-100">
                                        <input class="w-100 h-75 ps-3" for="stock" placeholder="stock" style="border-radius: 3px; border: 0.4px rgb(190, 189, 189) solid; box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.2);" name="stock">
                                        <span class="error-message" id="stock_error"></span>
                                     </div>
                                </div>
                            
                                <!-- Offer -->
                            
                                    
                                    <div class="  d-flex justify-content-center m-4">
                                    <button type="submit"  style="border-radius: 3px; border: 0.4px rgb(190, 189, 189) solid; box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.2); background-color: rgb(49, 49, 252);">add product</button>
                                   </div>
                              </div>
                          </div>
                       </div>
                    </form>
               </div>
              
           </div>
       </div>
       
   </content>
   <footer>
      <div class="container-fluid footer-color">
         <div class="container d-flex ">
               <div class="">
                    <div class="footer-div1 d-flex justify-content-center">
                         <h1 class="heading  pt-4">About us</h1>
                    </div>
                   <div class="footer-div1">
                
                       <p class="p-2">Welcome to Watch Universe, your ultimate destination for exquisite timepieces. At Watch Universe, we're passionate about bringing you the finest selection of watches that blend elegance, precision, and style.Our journey started with a love for craftsmanship and a desire to share the world's most stunning watches with watch enthusiasts and collectors alike.</p>
                       
                   </div>
               </div>
         </div>
      </div>
      <div class="container-fluid footer-color d-flex justify-content-center">
        <p class="p-5">&copy; 2023 All rights reserved.Desined by Aneesh</p>
      </div>
   </footer>
   <script>
       function checkImageCount() {

              console.log("enterring")
            const input = document.querySelector('input[type="file"]');
            const selectedFiles = input.files;

            if (selectedFiles.length > 4) {
                 Swal.fire({
                    icon: 'error',
                    title: 'Oops...',
                    text: 'You can select up to 4 images.',
                });
                input.value = null; // Clear the input
            }
        }
        

        
        
function validateForm() {
   
        
        var image = document.querySelector('input[name="filename"]')
        var file = document.querySelector('input[type="file"]')
        var productName = document.querySelector('input[name="product_name"]');
    var watchType = document.querySelector('select[name="watch_type"]')
    var price = document.querySelector('input[name="price"]');
    var brand = document.querySelector('select[name="brand"]');

    var discription = document.querySelector('input[name="discription"]');
    var displayType = document.querySelector('input[name="display_type"]');
    var strapColor = document.querySelector('input[name="strap_color"]');
    var dialColor = document.querySelector('input[name="dial_color"]');
    var gender = document.querySelector('input[name="gender"]');
    var shape = document.querySelector('input[name="shape"]');
    var watchCase = document.querySelector('input[name="watch_case"]');
    var stock = document.querySelector('input[name="stock"]');
    var offer = document.querySelector('input[name="offer"]');

    var nameRegex = /^(?=.*[A-Za-z])[A-Za-z\d\s]*[A-Za-z][A-Za-z\d\s]*$/;


    var priceRegex = /^\d+(\.\d{1,2})?$/; // Numeric with up to two decimal places
    var offerRegex = /^\d+(\.\d{1,2})?$/; // Numeric with up to two decimal places
    var discriptionError = document.querySelector('#discription_error');
    var imageError = document.querySelector('#image_error');

    console.log("-1")
     console.log("image",image.length)
     
     console.log(file.files,"???")
     

     var errorMessages = [];
     
     console.log(0)
     
     function showError(inputElement, errorMessage) {
         var errorSpan = inputElement.nextElementSibling; // Assumes the error span follows the input
         if (!errorSpan) {
             errorSpan = document.createElement('span');
             errorSpan.className = 'error-message';
             inputElement.parentNode.appendChild(errorSpan);
            }
            errorSpan.textContent = errorMessage;
            inputElement.classList.add('error');
        }
        
        function clearError(inputElement) {
            var errorSpan = inputElement.nextElementSibling;
            if (errorSpan) {
                errorSpan.textContent = '';
                inputElement.classList.remove('error');
            }
        }

        if (!image.value) {
            console.log("inside image")
            showError(image, 'Please select an image.');
            errorMessages.push('Please select an image.');
        } else {
            clearError(image);
        }

        if(file.files.length >1 && file.files.length <4){
            console.log("inside else")
            showError(image, 'Please select  4 images.');
            errorMessages.push('Please select 4 images.');
        }
        console.log("another -1")
    
    
        if (productName.value.trim() === '' || !nameRegex.test(productName.value.trim())) {
            showError(productName, 'Please enter a valid product name.');
            errorMessages.push('Please enter a valid product name.');
        } else {
            clearError(productName);
        }

        console.log(1)

    if (price.value.trim() === '' || !priceRegex.test(price.value.trim())) {
        showError(price, 'Please enter a valid product price (e.g., 12.34).');
        errorMessages.push('Please enter a valid product price (e.g., 12.34).');
    } else {
        clearError(price);
    }
    console.log(2)

    if (watchType.value === 'add watch type') {
            showError(watchType, 'Please select a watch type.');
            errorMessages.push('Please select a watch type.');
        } else {
            clearError(watchType);
        }

        // Validate brand
        if (brand.value === '') {
            showError(brand, 'Please select a brand.');
            errorMessages.push('Please select a brand.');
        } else {
            clearError(brand);
        }

        console.log(3)

 

    if (discription.value.trim() === '') {
    discriptionError.textContent = 'Please enter a product description.';
    errorMessages.push('Please enter a product description.');
} else {
    clearError(discription);
}
    console.log(4)
    
    if (displayType.value.trim() === '') {
        showError(displayType, 'Please enter a display type.');
        errorMessages.push('Please enter a display type.');
    } else {
        clearError(displayType);
    }
    console.log(5)

    if (strapColor.value.trim() === '') {
        showError(strapColor, 'Please enter a strap color.');
        errorMessages.push('Please enter a strap color.');
    } else {
        clearError(strapColor);
    }

    if (dialColor.value.trim() === '') {
        showError(dialColor, 'Please enter a dial color.');
        errorMessages.push('Please enter a dial color.');
    } else {
        clearError(dialColor);
    }

    if (gender.value.trim() === '') {
        showError(gender, 'Please enter a gender.');
        errorMessages.push('Please enter a gender.');
    } else {
        clearError(gender);
    }

    if (shape.value.trim() === '') {
        showError(shape, 'Please enter a shape.');
        errorMessages.push('Please enter a shape.');
    } else {
        clearError(shape);
    }

    if (watchCase.value.trim() === '') {
        showError(watchCase, 'Please enter a watch case material.');
        errorMessages.push('Please enter a watch case material.');
    } else {
        clearError(watchCase);
    }

    if (stock.value.trim() === '' || isNaN(stock.value.trim())) {
        showError(stock, 'Please enter a valid stock quantity.');
        errorMessages.push('Please enter a valid stock quantity.');
    } else {
        clearError(stock);
    }

    if (offer.value.trim() !== '' && !offerRegex.test(offer.value.trim())) {
        showError(offer, 'Please enter a valid offer amount.');
        errorMessages.push('Please enter a valid offer amount.');
    } else {
        clearError(offer);
    }
     
   

    return false;
    
}


function amountcheking(){
            const price = document.querySelector('input[name="price"]')
            const offer = document.querySelector('input[name="offer"]')
             

              
            
            if(parseInt(offer.value) >  parseInt(price.value) - 3){
                Swal.fire({
                    icon:'error',
                    title:'invalid offer',
                    text:'offer amount should be less than price'
                })
                document.getElementById('offer').value = 0
            }

            return false
            
        }



   </script>
</body>
</html>